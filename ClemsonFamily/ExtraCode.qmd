Created to correct the gray departments in key in the "Employees in Campus Housing". First code chunk started working and made this one unnecessary
```{r, echo=FALSE}
unique_departments <- unique(campus_residents$DepartmentPrimary)
num_departments <- length(unique_departments)

library(scales)
department_colors <- hue_pal()(num_departments)

names(department_colors) <- unique_departments

ggraph(campus_residents_graph, layout = "fr") +
    geom_edge_link(color = "gray80", alpha = 0.5) +
  geom_node_point(aes(color = DepartmentPrimary), size = 5) +
  geom_node_text(aes(label = name), repel = TRUE, size = 3) +
  theme_void() +
  ggtitle("Employees in Campus Housing") +
  scale_color_manual(values = department_colors, na.value = "black")
```


Broken:
```{r, echo=FALSE, results='hide'} 

#Create edges based on shared Clemson department
CFD_long <- ClemsonFamilyData %>%
    filter(!is.na(ClemsonDepartment) & ClemsonDepartment != "") %>% #filter rows with missing data in ClemsonDepartment
    separate_rows(ClemsonDepartment, sep = ",\\s*") #separates multi-select field    

#Join by ClemsonDepartment to identify relationships
dept_edges <- CFD_long %>%
    select(ID, ClemsonDepartment) %>%
    inner_join(CFD_long, by = c("ClemsonDepartment")) %>% 
    filter(ID.x < ID.y) %>% 
    select(source = ID.x, target = ID.y, ClemsonDepartment) %>%
    distinct()

dept_edges_undirected <- dept_edges %>%
    rowwise() %>%
    mutate(dept_edges = paste(sort(c(source,target)), collapse = "_")) %>%
    distinct(dept_edges, .keep_all = TRUE) %>%
    select(source, target, ClemsonDepartment)
```

Department network:
```{r, echo=FALSE}
#Visualization of department showConnections
dept_g <-graph_from_data_frame(dept_edges_undirected, directed = FALSE)

plot(dept_g,
    vertex.label = V(dept_g)$ID,
    vertex.size = 10,
    edge.color = "gray70",
    vertex.color = "skyblue",
    main = "Network of Shared Departments")
```

```{r}
#select column and filter nodes list to create edges list
nodes_list <- read.csv("ClemsonFamily_files/files/ClemsonFamilyNodesListVer4.csv") 
edges_list <- nodes_list %>%
    select(ID, ClemsonDepartment) %>%
    filter(!is.na(ClemsonDepartment) & ClemsonDepartment != "")

#transform edges_list into a data.frame
edges_list <- as.data.frame(edges_list)

str(edges_list)
```

```{r}
#filter nodes list
filtered_nodes_list <- nodes_list %>%
    filter(!is.na(ClemsonDepartment) & ClemsonDepartment != "")

filtered_nodes_list <- as.data.frame(filtered_nodes_list)

str(filtered_nodes_list)
```

```{r}
nodes <- filtered_nodes_list %>%
    rename(id = ID) %>%
    mutate(label = id)

edges <- edges_list %>%
  rename(from = ID, to = ClemsonDepartment)

visNetwork(nodes = nodes, edges = edges, height = "650px", width = "1100px") %>%
  visIgraphLayout(layout = "layout_with_fr", randomSeed = 12) %>%
  visNodes(size = 36, 
           font = list(size = 20)) %>%
  visEdges(color = list(color = "gray", opacity = 0.5),
           hoverWidth = 20,
           selectionWidth = 36)
```

```{r}
duplicated_ids <- nodes$id[duplicated(nodes$id)]
print(duplicated_ids)
```